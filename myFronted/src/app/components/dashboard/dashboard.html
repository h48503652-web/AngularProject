
<div class="dashboard-container">
  <div class="grid-ambient"></div>
  <div class="light-flares"></div>

  <div class="content-wrapper">
    <header class="main-header">
      <div class="header-content">
        <h1>סקירת מערכת</h1>
        <p class="dashboard-intro">NexusFlow היא מערכת לניהול צוותים, פרויקטים ומשימות במקום אחד. כאן תוכל לראות תמונת מצב בזמן אמת, להתעדכן בהתקדמות, ולנווט במהירות לעבודה היומיומית.</p>
        <p class="date-display">{{ now | date:'EEEE, d MMMM y' }}</p>
      </div>
      <div class="user-actions">
        <div class="live-indicator">
          <span class="pulse-dot"></span>
          Live Data
        </div>
      </div>
    </header>

    @if (loading()) {
      <div class="skeleton-loader">
        <div class="skeleton-grid"></div>
        <div class="skeleton-list"></div>
      </div>
    } @else {
      <div class="bento-grid">
        
        <div class="bento-card hero-card purple-theme">
          <div class="card-shine"></div>
          <div class="card-inner">
            <div class="card-header">
              <div class="icon-wrapper">
                <app-icon name="book" [size]="24"></app-icon>
              </div>
              <span class="trend-badge positive">+12% החודש</span>
            </div>
            <div class="card-body">
              <h3>פרויקטים פעילים</h3>
              <div class="big-number">{{ totalProjects() }}</div>
            </div>
            
            <svg class="mini-chart" viewBox="0 0 200 40" preserveAspectRatio="none">
              <path d="M0 30 Q 50 5, 100 20 T 200 10" vector-effect="non-scaling-stroke" />
              <linearGradient id="purple-gradient" x1="0" y1="0" x2="1" y2="0">
                  <stop offset="0%" stop-color="rgba(168, 85, 247, 0)" />
                  <stop offset="100%" stop-color="rgba(168, 85, 247, 0.4)" />
              </linearGradient>
              <path class="mini-chart-fill" d="M0 30 Q 50 5, 100 20 T 200 10 V 40 H 0 Z" fill="url(#purple-gradient)" />
            </svg>
          </div>
        </div>

        <div class="bento-card blue-theme">
          <div class="card-shine"></div>
          <div class="card-inner">
            <div class="icon-wrapper">
              <app-icon name="zap" [size]="24"></app-icon>
            </div>
            <h3>משימות לביצוע</h3>
            <div class="big-number">{{ pendingTasks() }}</div>
            <progress class="progress progress--blue" max="100" value="65" aria-label="התקדמות משימות"></progress>
          </div>
        </div>

        <div class="bento-card green-theme">
          <div class="card-shine"></div>
          <div class="card-inner">
            <div class="icon-wrapper">
              <app-icon name="check-circle" [size]="24"></app-icon>
            </div>
            <h3>אחוז השלמה</h3>
            <div class="big-number">{{ completionRate() }}<small>%</small></div>
            <progress class="progress progress--green" max="100" [value]="completionRate()" aria-label="אחוז השלמה"></progress>
          </div>
        </div>

        <div class="bento-card list-card tall-span">
          <div class="card-inner">
            <div class="list-header">
              <h3>פעילות אחרונה</h3>
              <a routerLink="/tasks" class="nav-link">הכל →</a>
            </div>
            <div class="activity-timeline">
              @for (task of recentTasks(); track task.id) {
                <div class="timeline-item">
                  <div class="timeline-marker" [class.done]="task.status === 'done'"></div>
                  <div class="timeline-content">
                    <span class="task-name">{{ task.title }}</span>
                    <span class="project-meta">פרויקט #{{ task.project_id }}</span>
                  </div>
                  <span class="status-pill" [class.done]="task.status === 'done'">
                    {{ task.status === 'done' ? 'הושלם' : 'פעיל' }}
                  </span>
                </div>
              } @empty {
                <div class="empty-list">אין פעילות להציג</div>
              }
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</div>
